---
bibliography: references.bib
---

![](img/foot.jpeg)

# `r fontawesome::fa("book", fill=" #4141f7")` : Control de calidad

```{=html}
<link href="
https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.min.css
" rel="stylesheet">
```
![](img/Banner.jpg)
Algunos pasos deben realizarse antes de poder usar las secuencias crudas recibidas:


- Remoción de adaptadores (Illumina, Nextera, etc).

- Filtrado de secuencias de baja calidad.

- Inspección de la calidad de secuencias.



Para realizar esto, seguiremos los siguientes pasos:

## fastp

```{bash, eval =FALSE}
$ conda create --yes -n qc fastp fastqc multiqc

$ conda activate qc

$ fastp --detect_adapter_for_pe
        --overrepresentation_analysis
        --correction --cut_right --thread 2
        --html trimmed/anc.fastp.html --json trimmed/anc.fastp.json
        -i data/anc_R1.fastq.gz -I data/anc_R2.fastq.gz
        -o trimmed/anc_R1.fastq.gz -O trimmed/anc_R2.fastq.gz
        
```

--detect_adapter_for_pe: Specifies that we are dealing with paired-end data.

--overrepresentation_analysis: Analyse the sequence collection for sequences that appear too often.

--correction: Will try to correct bases based on an overlap analysis of read1 and read2.

--cut_right: Will use quality trimming and scan the read from start to end in a window. If the quality in the window is below what is required, the window plus all sequence towards the end is discarded and the read is kept if its still long enough.

--thread: Specify how many concurrent threads the process can use.

--html and --json: We specify the location of some stat files.

-i data/anc_R1.fastq.gz -I data/anc_R2.fastq.gz: Specifies the two input read files

-o trimmed/anc_R1.fastq.gz -O trimmed/anc_R2.fastq.gz: Specifies the two desired output read files


## fastqc

- Correr fastq para checar secuencias (esto puede hacerse antes y después):

```{bash, eval =FALSE}
fastqc -o RESULT-DIR INPUT-FILE.fq(.gz) ...
```


## MultiQC

MultiQC compila los resultados de FastQC y fastp en una página web clara y consolidada, permitiendo contextualizar múltiples muestras fácilmente a partir de los directorios de salida.

```{bash, eval =FALSE}
multiqc DIRECTORY DIRECTORY ...
```


